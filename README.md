# vk_rest
внешняя компонента для 1С для общения с REST и работой с JSON

Написана на Delphi 10.2 Tokyo, предназначена для обеспечения возможности вызовов rest-запросов.

## Ограничения:

* компонента выполняет ТОЛЬКО POST запросы
* JSON для отправки должен быть сформирован в текстовом файле, таким образом можно отправлять запросы большого размера 
* ответ от сервера также сохраняется в файле и доступен в виде разобранного JSON для 1С с целью последующего разбора полученных данных
* кодировка файлов - win1251
* кодировка отправляемых данных - UTF-8
* сервер также должен предоставлять ответ в UTF-8, прочие варианты не тестировались и не гарантируется корректная работа компоненты

## Свойства

Каждое свойство может быть написано в английском регистре или в русском

* `URL (Ссылка)` - ссылка на вызываемый метод, например https://reqres.in/api/register
* `FileName (Файл)` - имя файла, в котором содержится json для запроса
* `FileResponse (ФайлОтвета)` - имя файла, в который будут записаны данные ответа. Файл должен отсутствовать либо быть доступным для записи, в противном случае - исключение и ответ будет потерян. Это свойство можно не указывать, в этом случае будет создан файл с именем <Filename>.response.json
* `StatusCode (КодСтатуса)` - стандартный http код ответа
* `TimeOut (Таймаут)` - таймаут запроса, по умолчанию 3 сек.
  
## Методы



*  `Request()` - считывает данные запроса из файла и выполняет запрос к серверу. 
Варианты `ВыполнитьЗапрос` `Выполнить`

*  `Success()` - возвращает 1, если в ответе пришел валидный JSON и его удалось корректно распознать. Иначе - 0. 
Варианты `JSONРазобран` `Разобран`

*  `GetValueType(name)` - возвращает тип значения ключа. Варианты `JSONТипЗначения` `ТипЗначения`

*  `GetValue(name)` - возвращает значение по ключу. Варианты `JSONЗначение` `Значение`

*  `GetArrayCount(name)` - возвращает количество элементов в массиве, если значением ключа является массив. Варианты `JSONРазмерМассива` `РазмерМассива`

*  `GetArrayValue(key,index,name)` - Варианты `JSONЗначениеИзМассива` `ЗначениеИзМассива`

*  `GetArrayValueType(key,index)` - Варианты `JSONТипЗначенияИзМассива` `ТипЗначенияИзМассива`

*  `SetRoot()` - Варианты `JSONУстановитьКорень` `УстановитьКорень`

*  `SetRootFromArray()` - Варианты `JSONУстановитьКореньЗначениемИзМассива` `УстановитьКореньИзМассива`

*  `ClearRoot()` -  Варианты `JSONСброситьКорень` `СброситьКорень`

*  `SetParentRoot()` - Варианты `JSONУстановитьПредыдущийКорень` `УстановитьПредыдущийКорень`

*  `GetPairsCount()` - Варианты `JSONКоличествоПар` `КоличествоПар`

*  `GetPairName()` - Варианты `JSONИмяПары` `ИмяПары`

*  `GetPairValue()` - Варианты `JSONЗначениеПары` `ЗначениеПары`

